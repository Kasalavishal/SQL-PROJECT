CREATE DATABASE VISHAL_ASSIGNMENT4
USE VISHAL_ASSIGNMENT4
CREATE TABLE STUDENTS_TABLE(
STUDENT_ID INT PRIMARY KEY,
STUDENT_NAME VARCHAR(50),
SURNAME VARCHAR(50),
BIRTHDATE DATE,
GENDER CHAR(1),
CLASS VARCHAR(5),
POINT INT);
SELECT * FROM STUDENTS_TABLE

INSERT INTO STUDENTS_TABLE(STUDENT_ID, STUDENT_NAME, surname,
birthdate, gender, class, point) VALUES
(1, 'John', 'Doe', '2005-01-15', 'M', '10A', 85),
(2, 'Jane', 'Smith', '2006-03-22', 'F', '10B', 90),
(3, 'Alice', 'Johnson', '2005-07-12', 'F', '10A', 88),
(4, 'Bob', 'Brown', '2006-11-30', 'M', '10C', 76),
(5, 'Charlie', 'Davis', '2005-05-05', 'M', '10B', 92),
(6, 'Diana', 'Miller', '2006-06-25', 'F', '10C', 81),
(7, 'Eve', 'Wilson', '2005-09-18', 'F', '10A', 87),
(8, 'Frank', 'Moore', '2006-12-02', 'M', '10B', 80),
(9, 'Grace', 'Taylor', '2005-04-17', 'F', '10C', 83),
(10, 'Hank', 'Anderson', '2006-10-20', 'M', '10A', 78)

CREATE TABLE BORROWS_TABLE(
BORROW_ID INT PRIMARY KEY,
STUDENT_ID INT,
BOOKS_ID INT,
TAKENDATE INT,
BROUGHTDATE INT);
ALTER TABLE BORROWS_TABLE

ADD BROUGHTDATE DATE

INSERT INTO BORROWS_TABLE(borrow_Id, student_Id, BOOKS_ID,
takenDate, broughtDate) VALUES
(1, 1, 3, '2024-01-10', '2024-01-20'),
(2, 2, 5, '2024-01-12', '2024-01-22'),
(3, 3, 7, '2024-01-15', '2024-01-25'),
(4, 4, 2, '2024-01-18', '2024-01-28'),
(5, 5, 1, '2024-01-20', '2024-01-30'),
(6, 6, 4, '2024-01-22', '2024-02-01'),
(7, 7, 6, '2024-01-24', '2024-02-03'),
(8, 8, 8, '2024-01-26', '2024-02-05'),
(9, 9, 10, '2024-01-28', '2024-02-07'),
(10, 10, 9, '2024-01-30', '2024-02-09');

CREATE TABLE BOOKS_TABLE(
BOOK_ID INT PRIMARY KEY,
BOOK_NAME VARCHAR(100),
PAGE_COUNT INT,
POINT INT,
AUTHOR_ID INT,
TYPE__ID INT);

INSERT INTO BOOKS_TABLE(BOOK_ID, BOOK_NAME, PAGE_COUNT, point,
AUTHOR_ID, TYPE__ID) VALUES
(1, 'The Great Gatsby', 180, 95, 1, 1),
(2, 'To Kill a Mockingbird', 281, 90, 2, 2),
(3, '1984', 328, 88, 3, 3),
(4, 'Pride and Prejudice', 279, 93, 4, 4),
(5, 'The Catcher in the Rye', 214, 85, 5, 1),
(6, 'The Hobbit', 310, 91, 6, 2),
(7, 'Moby-Dick', 635, 80, 7, 3),
(8, 'War and Peace', 1225, 92, 8, 4),
(9, 'Ulysses', 730, 89, 9, 1),
(10, 'The Odyssey', 541, 87, 10, 2);

CREATE TABLE AUTHORS_TABLE(
AUTHOR_ID INT PRIMARY KEY,
AUTHOR_NAME VARCHAR(100),
SURNAME VARCHAR(100));

INSERT INTO AUTHORS_TABLE(AUTHOR_ID, AUTHOR_NAME, surname) VALUES
(1, 'F. Scott', 'Fitzgerald'),
(2, 'Harper', 'Lee'),
(3, 'George', 'Orwell'),
(4, 'Jane', 'Austen'),
(5, 'J.D.', 'Salinger'),
(6, 'J.R.R.', 'Tolkien'),
(7, 'Herman', 'Melville'),
(8, 'Leo', 'Tolstoy'),
(9, 'James', 'Joyce'),
(10, 'Homer', '');

CREATE TABLE TYPES_TABLE(
TYPE__ID INT PRIMARY KEY,
TYPE__NAME VARCHAR(50));

INSERT INTO TYPES_TABLE(TYPE__ID, TYPE__NAME) VALUES
(1, 'Fiction'),
(2, 'Classic'),
(3, 'Dystopian'),
(4, 'Literature'),
(5, 'Fantasy'),
(6, 'Adventure'),
(7, 'Historical Fiction'),
(8, 'Science Fiction'),
(9, 'Mythology'),
(10, 'Philosophy');

--EXAMPLE 1 
SELECT * FROM STUDENTS_TABLE
--EXAMPLE 2 
SELECT STUDENT_NAME, SURNAME, CLASS FROM STUDENTS_TABLE
--EXAMPLE 3
SELECT * FROM STUDENTS_TABLE
WHERE GENDER = 'F'
--EXAMPLE 4 
select distinct(class) from STUDENTS_TABLE
--example 9
SELECT * FROM STUDENTS_TABLE
WHERE STUDENT_NAME LIKE 'A%'
--EXAMPLE 11
SELECT * FROM STUDENTS_TABLE
WHERE STUDENT_NAME IN ('EMMA', 'SOPHIA', 'ROBERT')
--EXAMPLE 12
SELECT * FROM STUDENTS_TABLE
WHERE STUDENT_NAME LIKE 'A%'
OR STUDENT_NAME LIKE 'D%'
OR STUDENT_NAME LIKE 'K%'
--EXAMPLE 15
SELECT * FROM STUDENTS_TABLE
WHERE YEAR(BIRTHDATE) = '2006'
--EXAMPLE 16
SELECT * FROM STUDENTS_TABLE
WHERE GENDER = 'F' AND STUDENT_ID BETWEEN 2AND 6
--EXAMPLE 17
SELECT * FROM STUDENTS_TABLE
ORDER BY STUDENT_NAME
--EXAMPLE 21
SELECT * FROM STUDENTS_TABLE
SELECT TOP 5 STUDENT_NAME, SURNAME, BIRTHDATE  FROM STUDENTS_TABLE	
--EXAMPLE 20
SELECT TOP 10 STUDENT_NAME FROM STUDENTS_TABLE
--EXAMPLE 22
SELECT * FROM BOOKS_TABLE
SELECT BOOK_NAME FROM BOOKS_TABLE WHERE PAGE_COUNT= (SELECT MAX(PAGE_COUNT) AS [MAX PAGE COUNT] FROM BOOKS_TABLE)
--EXAMPLE 25
SELECT * FROM BOOKS_TABLE
WHERE BOOK_NAME LIKE '_H%'
--EXAMPLE 26
SELECT STUDENT_NAME, CLASS FROM STUDENTS_TABLE
GROUP BY CLASS

SELECT  class, STRING_AGG(STUDENT_NAME + ' ' + SURNAME, ', ') AS students_in_class
FROM STUDENTS_TABLE
GROUP BY class;
--example 28
SELECT * FROM STUDENTS_TABLE
WHERE STUDENT_NAME = 'JOHN'
--EXAMPLE 30
INSERT INTO AUTHORS_TABLE(AUTHOR_ID,AUTHOR_NAME,SURNAME)
VALUES
(11,'SMITH','ALLIEN')
SELECT * FROM AUTHORS_TABLE
--example 23
SELECT BIRTHDATE, STUDENT_NAME FROM STUDENTS_TABLE
ORDER BY BIRTHDATE DESC
--EXAMPLE 38
UPDATE STUDENTS_TABLE
SET POINT = POINT+5
--EXAMPLE 40
SELECT STUDENT_ID FROM STUDENTS_TABLE
WHERE BIRTHDATE = NULL
--EXAMPLE 39
SELECT * FROM AUTHORS_TABLE
DELETE FROM AUTHORS_TABLE
WHERE AUTHOR_ID = 2
--EXAMPLE 41
SELECT * FROM STUDENTS_TABLE
SELECT * FROM BORROWS_TABLE
SELECT S.STUDENT_NAME, S.SURNAME, B.TAKENDATE
FROM STUDENTS_TABLE S
INNER JOIN BORROWS_TABLE B ON S.STUDENT_ID = B.STUDENT_ID