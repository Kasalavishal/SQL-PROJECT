CREATE DATABASE VISHALASSIGNMENT2
USE VISHALASSIGNMENT2
CREATE TABLE EMPLOYEEDETAILS (
EmpId INT PRIMARY KEY,
 FullName VARCHAR(100),
 ManagerId INT,
 DateOfJoining DATE,
 City VARCHAR(100)
);
CREATE TABLE EMPLOYEESALARY (
EmpId INT,
 Project VARCHAR(50),
 Salary DECIMAL(10, 2),
 Variable DECIMAL(10, 2),
 FOREIGN KEY (EmpId) REFERENCES
EmployeeDetails(EmpId));

INSERT INTO EmployeeDetails (EmpId, FullName, ManagerId,
DateOfJoining, City) VALUES
(101, 'Alice Johnson', 321, '2022-05-15', 'New York'),
(102, 'Bob Smith', 876, '2020-03-12', 'Los Angeles'),
(103, 'Charlie Brown', 986, '2021-08-23', 'Chicago'),
(104, 'David Williams', 876, '2019-11-05', 'Houston'),
(105, 'Eve Davis', 321, '2023-01-07', 'Phoenix'),
(106, 'Frank Miller', 986, '2018-12-19', 'Philadelphia'),
(107, 'Grace Wilson', 876, '2022-03-28', 'San Antonio'),
(108, 'Hank Moore', 321, '2021-09-14', 'San Diego'),
(109, 'Ivy Taylor', 986, '2020-02-11', 'Dallas'),
(110, 'Jack Anderson', 876, '2022-11-30', 'San Jose'),
(111, 'Karen Thomas', 321, '2021-07-16', 'Austin'),
(112, 'Liam Jackson', 986, '2023-04-21', 'Fort Worth'),
(113, 'Mia White', 876, '2019-06-03', 'Columbus'),
(114, 'Noah Harris', 321, '2020-12-10', 'Charlotte'),
(115, 'Olivia Martin', 986, '2021-10-25', 'San Francisco'),
(116, 'Paul Garcia', 876, '2023-07-18', 'Indianapolis'),
(117, 'Quinn Martinez', 321, '2022-09-07', 'Seattle'),
(118, 'Rachel Rodriguez', 986, '2020-01-15', 'Denver'),
(119, 'Steve Clark', 876, '2021-03-19', 'Washington'),
(120, 'Tina Lewis', 321, '2019-08-31', 'Boston');

INSERT INTO EmployeeSalary (EmpId, Project, Salary, Variable)
VALUES
(101, 'P1', 7500, 500),
(102, 'P2', 9200, 700),
(103, 'P1', 6700, 600),
(104, 'P3', 8300, 900),
(105, 'P2', 7800, 800),
(106, 'P3', 9100, 1000),
(107, 'P1', 6200, 400),
(108, 'P2', 8800, 750),
(109, 'P3', 9500, 1100),
(110, 'P1', 7200, 650),
(111, 'P2', 8700, 850),
(112, 'P3', 9300, 1200),
(113, 'P1', 7900, 550),
(114, 'P2', 6800, 450),
(115, 'P3', 8400, 900),
(116, 'P1', 7600, 500),
(117, 'P2', 8900, 1000),
(118, 'P3', 9200, 1100),
(119, 'P1', 8100, 600),
(120, 'P2', 8300, 750);

--PART 1
--1
select * from EMPLOYEEDETAILS
select e.fullname from EMPLOYEEDETAILS e
left join EMPLOYEESALARY es on e.EmpId = es.EmpId
where es.EmpId is  null

--2
SELECT * FROM EMPLOYEEDETAILS
SELECT * FROM EMPLOYEESALARY
SELECT E.FULLNAME, E.EmpId,ES.PROJECT FROM EMPLOYEEDETAILS E
LEFT JOIN EMPLOYEESALARY ES ON E.EmpId = ES.EmpId
WHERE ES.Project IS NULL

--3
SELECT * FROM EMPLOYEEDETAILS
WHERE YEAR(DateOfJoining) = '2020'

--4
select e.fullname ,e.empid,es.salary
from EMPLOYEEDETAILS e
inner join employeesalary es on e.empid = es.empid

--5
SELECT Project, COUNT(PROJECT) AS [PROJECT-WISE COUNT]  FROM EmployeeSalary
GROUP BY Project

--6
SELECT E.EMPID, E.FULLNAME, ES.SALARY FROM EMPLOYEEDETAILS E
LEFT JOIN EMPLOYEESALARY ES ON E.EmpId = ES.EmpId

--7
select e.fullname as employees_managers from EmployeeDetails e
join EmployeeDetails ed
on e.managerid = ed.EmpId

--8
select empid,count(empid) as duplicate_records from EmployeeDetails 
group by EmpId
having count(empid) > 1

--part 2
--1
SELECT EMPID, FULLNAME  FROM EMPLOYEEDETAILS
WHERE ManagerId = 986

--2
SELECT DISTINCT(PROJECT) FROM EMPLOYEESALARY

--3
SELECT COUNT(Project) AS COUNT_EMP FROM EMPLOYEESALARY
WHERE PROJECT = 'P1'

--4
SELECT MAX(SALARY) AS MAXI_SAL, MIN(SALARY) AS MINI_SAL , AVG(SALARY) AS AVG_SAL FROM EMPLOYEESALARY

--5
SELECT EMPID,Salary  FROM EMPLOYEESALARY
WHERE Salary BETWEEN 9000 AND 15000

--6
SELECT * FROM EMPLOYEEDETAILS
SELECT FULLNAME FROM EMPLOYEEDETAILS
WHERE City = 'TORONTO' AND ManagerId = 321

--7
SELECT FULLNAME, EMPID FROM EMPLOYEEDETAILS
WHERE CITY = 'CALIFORNIA' AND ManagerId = 321

--8
SELECT EmpId FROM EMPLOYEESALARY
WHERE PROJECT = 'P1'

--9
SELECT SUM(SALARY) AS TOTAL_SAL FROM EMPLOYEESALARY

--10
SELECT FULLNAME FROM EMPLOYEEDETAILS
WHERE FullName LIKE '___%HN%'

--PART 3
--1
SELECT E.EMPID  FROM EMPLOYEEDETAILS E
FULL OUTER JOIN EMPLOYEESALARY ES ON E.EMPID = ES.EmpId

--2
SELECT * FROM EMPLOYEEDETAILS
SELECT * FROM EMPLOYEESALARY
SELECT E.EMPID, E.FULLNAME, ES.PROJECT, ES.SALARY FROM EMPLOYEEDETAILS E
INNER JOIN EMPLOYEESALARY ES ON E.EmpId = ES.EmpId

--3
SELECT E.FULLNAME, E.EMPID FROM EMPLOYEEDETAILS E
LEFT JOIN EMPLOYEESALARY ES ON E.EmpId = ES.EmpId

--4
SELECT E.EMPID FROM EMPLOYEEDETAILS E
INNER JOIN EMPLOYEESALARY ES ON  E.EMPID = ES.EmpId

--5
SELECT E.EMPID FROM EMPLOYEEDETAILS E
LEFT JOIN EMPLOYEESALARY ES ON  E.EMPID = ES.EmpId

--6
SELECT * FROM EMPLOYEEDETAILS
SELECT REPLACE(FULLNAME, ' ', '_') AS FULLNAME_NOSPACE
FROM EMPLOYEEDETAILS

--8
SELECT EMPID, MANAGERID FROM EMPLOYEEDETAILS

--10
SELECT UPPER(FULLNAME) AS UPP_CASE , LOWER(CITY) AS LOWER_CASE FROM EMPLOYEEDETAILS

--9
SELECT * FROM EMPLOYEEDETAILS
WHERE FULLNAME LIKE '_A%'

--7
SELECT EMPID,FULLNAME,
CHARINDEX('A',FULLNAME) AS POSITION_OF_A
FROM EmployeeDetails

--PART 4

--3
SELECT E.EMPID, E.FULLNAME, ES.PROJECT FROM EMPLOYEEDETAILS E
LEFT JOIN EMPLOYEESALARY ES ON E.EmpId = ES.EmpId
WHERE ES.Project IS NULL

--4		
SELECT E.EMPID, E.FULLNAME, ES.PROJECT FROM EMPLOYEEDETAILS E
JOIN EMPLOYEESALARY ES ON E.EmpId = ES.EmpId
WHERE Salary >=5000 and Salary <=10000

--5
SELECT GETDATE() AS DATE__

--6
SELECT FULLNAME FROM EMPLOYEEDETAILS
where year(DateOfJoining)=2020

--7
SELECT E.EMPID, E.FULLNAME, ES.SALARY FROM EMPLOYEEDETAILS E
JOIN EMPLOYEESALARY ES ON E.EmpId = ES.EmpId

--9

SELECT E.EMPID, E.FULLNAME, ES.SALARY FROM EMPLOYEEDETAILS E
LEFT JOIN EMPLOYEESALARY ES ON E.EmpId = ES.EmpId


